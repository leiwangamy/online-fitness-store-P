<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fitness Club & Online Store</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #d8f3dc;   /* light green */
        }
          .top-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
        nav a {
            margin-right: 15px;
            font-weight: bold;
        }
        section {
            margin-bottom: 40px;
        }
        h1, h2 {
            margin-bottom: 10px;
        }
        button {
            padding: 8px 15px;
            font-size: 1rem;
            margin-right: 10px;
        }
         .account-area {
        padding: 4px 8px;
        border-radius: 4px;
        background: #eef;
        font-size: 0.9rem;
        }

        .account-area a {
        font-weight: normal;
        }

        /* Simple product card layout */
        .products-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .product-card {
            border: 1px solid #ccc;
            padding: 10px;
            width: 220px;
            text-align: center;
        }
        .product-img {
            max-width: 200px;
            max-height: 200px;
            display: block;
            margin: 0 auto 10px auto;
            object-fit: cover;
        }

        /* Pagination styles */
        .pagination {
            margin-top: 20px;
            text-align: center;
        }
        .pagination .step-links a,
        .pagination .step-links .disabled {
            margin: 0 6px;
            padding: 4px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-decoration: none;
            display: inline-block;
        }
        .pagination .step-links a {
            background: #fafafa;
            color: purple;
        }
        .pagination .step-links a:hover {
            background: #eee;
        }
        .pagination .current {
            margin: 0 5px;
            padding: 5px 10px;
            font-weight: bold;
        }
        .pagination .disabled {
            color: #aaa;
            background: #f9f9f9;
            border-style: dashed;
            cursor: default;
        }
    </style>
</head>

<body>

<header>
    <h1>My Fitness Club</h1>

    <nav class="top-nav">
        <div class="nav-links">
            <a href="{% url 'home' %}">Home</a>
            <a href="{% url 'cart_detail' %}">Cart</a>
            <a href="{% url 'login' %}">Member Login</a>
            <a href="{% url 'signup' %}">Sign Up</a>
            <a href="/admin/">Admin (staff only)</a>
        </div>

        <div class="account-area">
            {% if user.is_authenticated %}
                ðŸ‘¤ You are logged in as <strong>{{ user.username }}</strong>.
                <a href="{% url 'logout' %}">Logout</a>
            {% else %}
                ðŸ‘¤ <a href="{% url 'login' %}">Login</a>
                or
                <a href="{% url 'signup' %}">Sign Up</a>.
            {% endif %}
        </div>
    </nav>

    <hr>
</header>


<!-- Membership section -->
<section>
    <h2>Welcome to the Fitness Club</h2>

    
    <p>
        Join our membership to access classes, coaching, and exclusive discounts in our online store.
    </p>

    <a href="{% url 'login' %}">
        <button type="button">Member Login</button>
    </a>
</section>

<hr>

<!-- Store section -->
<section>
    <h2>Featured Products</h2>

    <!-- ðŸ” Search bar -->
    <form method="get" style="margin-bottom: 15px;">
        <input type="text"
               name="q"
               placeholder="Search products..."
               value="{{ search_query }}"
               style="padding: 5px 8px; width: 220px;">

        {% if selected_category %}
            <input type="hidden" name="category" value="{{ selected_category }}">
        {% endif %}

        <button type="submit">Search</button>
    </form>

    <!-- Category filter links -->
    <div style="margin-bottom: 20px;">
        {# All = no category param, but keep search if any #}
        <a href="?{% if search_query %}q={{ search_query|urlencode }}{% endif %}"
           style="margin-right: 10px; {% if not selected_category %}font-weight:bold{% endif %}">
            All
        </a>

        {% for cat in categories %}
            <a href="?category={{ cat.slug }}{% if search_query %}&q={{ search_query|urlencode }}{% endif %}"
               style="margin-right: 10px; {% if selected_category == cat.slug %}font-weight:bold{% endif %}">
                {{ cat.name }}
            </a>
        {% endfor %}
    </div>

    {% if page_obj %}
        <div class="products-container">
            {% for product in page_obj %}
                <div class="product-card">
                    {% if product.main_image %}
                        <img src="{{ product.main_image }}" class="product-img" alt="{{ product.name }}">
                    {% else %}
                        <img src="/static/no-image.png" class="product-img" alt="No image">
                    {% endif %}

                    <h3>{{ product.name }}</h3>
                    <p>${{ product.price }}</p>
                    <a href="{% url 'product_detail' product.pk %}">View Details</a>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No products available yet.</p>
    {% endif %}

    <!-- Pagination -->
    {% if page_obj %}
    <div class="pagination">
        <span class="step-links">

            {% if page_obj.has_previous %}
                <a href="?page=1
                    {% if selected_category %}&category={{ selected_category }}{% endif %}
                    {% if search_query %}&q={{ search_query|urlencode }}{% endif %}
                ">&laquo; first</a>

                <a href="?page={{ page_obj.previous_page_number }}
                    {% if selected_category %}&category={{ selected_category }}{% endif %}
                    {% if search_query %}&q={{ search_query|urlencode }}{% endif %}
                ">previous</a>
            {% else %}
                <span class="disabled">&laquo; first</span>
                <span class="disabled">previous</span>
            {% endif %}

            <span class="current">
                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
            </span>

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}
                    {% if selected_category %}&category={{ selected_category }}{% endif %}
                    {% if search_query %}&q={{ search_query|urlencode }}{% endif %}
                ">next</a>

                <a href="?page={{ page_obj.paginator.num_pages }}
                    {% if selected_category %}&category={{ selected_category }}{% endif %}
                    {% if search_query %}&q={{ search_query|urlencode }}{% endif %}
                ">last &raquo;</a>
            {% else %}
                <span class="disabled">next</span>
                <span class="disabled">last &raquo;</span>
            {% endif %}

        </span>
    </div>
    {% endif %}

</section>

</body>
</html>
