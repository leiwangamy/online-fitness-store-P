{% extends "base.html" %}

{% block title %}Blog – Fitness Club{% endblock %}

{% block extra_css %}
<style>
  .blog-container {
    max-width: 900px;
    margin: 30px auto;
    padding: 30px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  .blog-container h1 {
    color: #2d6a4f;
    margin-bottom: 30px;
    font-size: 2.5rem;
  }

  .blog-posts {
    display: grid;
    gap: 30px;
  }

  .blog-post {
    padding: 25px;
    background: #f0f8f4;
    border-left: 4px solid #2d6a4f;
    border-radius: 5px;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .blog-post:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }

  .blog-post h2 {
    color: #2d6a4f;
    font-size: 1.5rem;
    margin-bottom: 15px;
  }

  .blog-post h2 a {
    color: #2d6a4f;
    text-decoration: none;
  }

  .blog-post h2 a:hover {
    text-decoration: underline;
  }

  .blog-post-meta {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 15px;
  }

  .blog-post p {
    line-height: 1.6;
    color: #333;
    margin-bottom: 10px;
  }

  .blog-post-excerpt {
    font-style: italic;
    color: #555;
    margin-bottom: 15px;
  }

  .blog-post-image {
    max-width: 100%;
    width: 100%;
    max-height: 360px;
    height: auto;
    object-fit: contain;
    border-radius: 5px;
    margin-bottom: 15px;
  }

  .pagination {
    margin-top: 30px;
    text-align: center;
  }

  .pagination a {
    padding: 8px 16px;
    margin: 0 4px;
    text-decoration: none;
    color: #0066cc;
    border: 1px solid #ddd;
    border-radius: 4px;
  }

  .pagination a:hover {
    background: #f0f0f0;
  }

  .pagination .current {
    padding: 8px 16px;
    margin: 0 4px;
    background: #2d6a4f;
    color: white;
    border: 1px solid #2d6a4f;
    border-radius: 4px;
  }
</style>
{% endblock %}

{% block content %}
<div class="blog-container">
  <h1>Blog</h1>
  
  {% if posts %}
    <div class="blog-posts">
      {% for post in posts %}
        <div class="blog-post">
          {# Show featured_image first if available, otherwise show first gallery image #}
          {% if post.featured_image %}
            <img src="{{ post.featured_image.url }}" alt="{{ post.title }}" class="blog-post-image">
          {% elif post.images.all %}
            <img src="{{ post.images.first.image.url }}" alt="{{ post.images.first.alt_text|default:post.title }}" class="blog-post-image">
          {% endif %}
          <h2><a href="{% url 'core:blog_detail' post.slug %}">{{ post.title }}</a></h2>
          <div class="blog-post-meta">
            Posted on: {{ post.published_date|date:"F d, Y" }} by {{ post.author }}
            {% if post.view_count > 0 %}
              | Views: {{ post.view_count }}
            {% endif %}
          </div>
          {% if post.excerpt %}
            <p class="blog-post-excerpt">{{ post.excerpt }}</p>
          {% endif %}
          <p>{{ post.content|truncatewords:50|safe }}</p>
          <a href="{% url 'core:blog_detail' post.slug %}">Read more →</a>
        </div>
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if page_obj.has_other_pages %}
      <div class="pagination">
        {% if page_obj.has_previous %}
          <a href="?page=1">« First</a>
          <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
        {% endif %}
        
        <span class="current">
          Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
        </span>
        
        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}">Next</a>
          <a href="?page={{ page_obj.paginator.num_pages }}">Last »</a>
        {% endif %}
      </div>
    {% endif %}
  {% else %}
    <p>No blog posts available yet. Check back soon!</p>
  {% endif %}
</div>
{% endblock %}

